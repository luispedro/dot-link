\subsection{Implementation and Data Sets}

The code was implemented in the C~Language, starting from an open-source implementation~\cite{ansicimplementation}.

Three data sets were used:

\begin{enumerate}
\item The English translation of ``Democracy in America'' by Alexis de Tocqueville as natural language example
\item The DNA of S. Cervesiae (first chromosome)
\item Randomly generated text by a uniform distribution
\end{enumerate}

The machine used for testing was an Intel Pentium~IV at 2.40GHz with 4Gb of main memory.

\subsection{Indexing Time and Size}

We report the indexing time and size (as a count of the nodes in the structure) as a function of the number of character (by using larger and larger suffixes of the datasets).

\begin{figure}%
\centering
\subfigure[English Text]{
\includegraphics[width=.25\textwidth]{ratio-in=english-0-1.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=english-1-2.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=english-2-3.eps}%
}
\\
\subfigure[DNA]{
\includegraphics[width=.25\textwidth]{ratio-in=dna-0-1.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=dna-0-1.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=dna-1-2.eps}%
}
\\
\subfigure[Random Text]{
\includegraphics[width=.25\textwidth]{ratio-in=random-0-1.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=random-0-1.eps}%
\includegraphics[width=.25\textwidth]{ratio-in=random-1-2.eps}%
}
\caption{Ratios of k-error and (k+1)-error dotted trees}\label{fig:ratios}%
\end{figure}

To experimentally verify the average case, we show in Figures~\ref{fig:ratios} the ratios between the k-error and the (k+1)-error dotted trees. We can easily see that for all three data sets, the experimental values do resemble a logarithm as predicted.

\subsection{Search Time}

For searching, the full texts were first indexed and then online searches were performed on top of the structure. To generate input patterns, randomly chosen bits of the text were taken. These patterns were then altered by substituting a character at random. To generate mismatches, one character too many was altered~\footnote{Since the characters used were not present in the original text, there is no risk of generating a string which \emph{does appear} in the text.}. The search algorithm performed an early exit, without reporting of occurrences (ie, it only reported whether the string exists in the text). Therefore, the number of occurrences had no influence on the search time.

\begin{figure}
\includegraphics[width=\textwidth]{search-time-vary-m.k=2.in=english-100k.eps}
\caption{Search time versus pattern size}\label{fig:search-vary-m}
\end{figure}

Figure~\ref{fig:search-vary-m} shows the search time for growing pattern lenghts. It shows the case where the pattern exists and where it does not (an extra error is added). The fact that the search is done using an early-exit strategy explains why non existing patterns take longer than existing patterns. The value presented is the number of character comparisons the algorithm makes.
