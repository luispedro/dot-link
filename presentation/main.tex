\documentclass{beamer}

\usetheme{Darmstadt}

\usepackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade}
\usepackage{amsmath,amssymb}
\usepackage[latin1]{inputenc}
\usepackage{colortbl}
\usepackage[english]{babel}

\title{Dotted Suffix Trees\\A Structure for Approximate Text Indexing}
\author{Lu\'{\i}s Pedro Coelho \and Arlindo L. Oliveira}
\date{}

\graphicspath{{figures/}{../paper/figures}}
\newcommand*{\puttree}[1]{\begin{center}\rotatebox{270}{\includegraphics[height=.8\textwidth]{#1}}\end{center}}



\AtBeginSection[] % Do nothing for \subsection*
{
	\begin{frame}<beamer>
		\frametitle{Outline}
		\tableofcontents[currentsection,currentsubsection]
	\end{frame}
}


\begin{document}
\frame{\titlepage}
\frame{\tableofcontents}
\section{Suffix Trees}
\frame{
%\frametitle{Suffixes of a String}

\begin{block}{$\mathcal{T}=$mississippi}

\begin{minipage}{18em}	
\begin{flushright}	
\texttt{mississippi\$}\\
 \texttt{ississippi\$}\\
  \texttt{ssissippi\$}\\
   \texttt{sissippi\$}\\
    \texttt{issippi\$}\\
     \texttt{ssippi\$}\\
      \texttt{sippi\$}\\
       \texttt{ippi\$}\\
        \texttt{ppi\$}\\
         \texttt{pi\$}\\
          \texttt{i\$}\\
           \texttt{\$}\\
\end{flushright}
\end{minipage}
\end{block}
}

\frame{

%\frametitle{Suffix Tree}

\begin{block}{Suffix Tree for $\mathcal{T}=$mississippi}
\begin{overprint}
\centering
\onslide<1>\puttree{mississippi-0-no-sl}
\onslide<2>\puttree{mississippi-0}
\onslide<3>\puttree{mississippi-0}
\end{overprint}
\smallskip
\flushright
\onslide<3>Can be built in $\mathcal{O}(n)$ time.
\end{block}

}


\frame{
%\frametitle{Searching in Suffix Trees}

\begin{block}{%
$\mathcal{T}=$ mississippi\$\\
$\mathcal{P}=$ ssi}
\begin{overprint}
\centering
\onslide<1>\puttree{mississippi-0-no-sl}
\onslide<2>\puttree{search-i}
\onslide<3>\puttree{search-ii}
\onslide<4>
\puttree{search-ii}

\flushright{}ssi found!
\end{overprint}
\end{block}

}

\section{Approximate Matching}
\newlength{\pequals}
\newcommand*{\now}{$\mathcal{P}= $\texttt{\ \ \ sxi}}
\frame{
%\frametitle{Approximatte Matching}
\settowidth{\pequals}{\now}

\begin{block}<1->{Substituition (aka Hamming) distance}
$\mathcal{P}$ matches $\mathcal{T}$ with up to $k$ substitutions iff we can change
$k$ (or less) characters in $\mathcal{P}$ so that it matches $\mathcal{T}$
\end{block}

\begin{block}<2->{Example: $\mathcal{P}=$ \texttt{sxi}}
$\mathcal{T}=$\texttt{\ mississippi}\$\\
\visible<3>{\now${}_1$\\}
\visible<4>{\hspace{\pequals}\texttt{\texttt{sxi}${}_2$}}
%\visible<5->{\hspace{\pequals}\texttt{\ \texttt{sxi}${}_3$}}
\end{block}

}

\frame{
\begin{block}{Traditional Way}
Search for \emph{all the possible strings}

\begin{itemize}
\item mxi, pxi, sxi, ixi\dots
\item smi, spi, ssi, sii\dots
\item sxm, sxp, sss, sxi\dots
\end{itemize}
\end{block}

Number of possibilities: $\mathcal{O}(m|\Sigma|^{C_m^k})$
}

\frame{

\begin{block}<1->{First Intuition}
\begin{itemize}
\item It doesn't matter what the substituting character is
\end{itemize}
\end{block}

\begin{block}<2->{Pattern $\mathcal{P}=$sxi}
\begin{itemize}
\item The pattern can be divided into
\begin{itemize}
\item \texttt{sxi}
\item \texttt{.si}
\item \texttt{s.i}
\item \texttt{sx.}
\end{itemize}
\end{itemize}
\end{block}

}

\frame{
%\frametitle{First Intituion (Text Transformation)}

\begin{block}{Same Transformation on $\mathcal{T}=$mississippi}
\begin{itemize}
\item \texttt{mississippi}
\item \texttt{.ississippi}
\item \texttt{m.ssissippi}
\item \texttt{mi.sissippi}
\item \texttt{mis.issippi}
\item \texttt{miss.ssippi}
\item \texttt{missi.sippi}
\item \texttt{missis.ippi}
\item \texttt{mississ.ppi}
\item \texttt{mississi.pi}
\item \texttt{mississip.i}
\item \texttt{mississipp.}
\end{itemize}
\flushright{}Na\"\i{}ve tree: $\mathcal{O}(n^{k+1})$ nodes
\end{block}


}

\frame{
\frametitle{Generated Tree (Multiple Branched Nodes)}

\begin{block}{Needed Nodes}
\puttree{needed-nodes}
\end{block}

}
\frame{
\frametitle{Generated Tree (Dot-Only Branched Nodes)}

\begin{block}{Unneeded Nodes}
\centering \includegraphics[height=.5\textheight,angle=270]{unneeded}
\end{block}

}


\frame{
%\frametitle{Generated Tree (compression)}
\begin{block}{Compressing Nodes}
\centering \includegraphics[height=.5\textheight,angle=270]{half-implicit}
\end{block}

}
\frame{
%\frametitle{Generated Tree (implicit nodes)}

\begin{block}{Implicit Nodes}
\centering \includegraphics[height=.4\textheight,angle=270]{fully-implicit}
\end{block}
}
\frame{
\begin{block}{Resulting Tree: Dotted Suffix Tree}
\puttree{mississippi-1-no-sl}
\end{block}

}


\frame{
%\frametitle{Dotted Suffix Tree (space cost)}

\begin{block}{Number of nodes}
\begin{itemize}
\item Traditional worst-case analysis: $\mathcal{O}(n^{k+1})$
\item Expected case (under \emph{very general} assumptions): $\mathcal{O}(n \log^k n)$
\end{itemize}
\end{block}

}


\section{Searching}

\frame{

%\frametitle{Searching}

\begin{block}{$\mathcal{P}=\mathit{sxip}$}
Looking for \texttt{sxip}, \texttt{.xip}, \texttt{s.ip}, \texttt{sx.p}, and \texttt{sxi.}
\end{block}

\begin{block}{$\mathcal{T}=$mississippi}
\begin{overprint}
\onslide<1>\puttree{mississippi-1}
\onslide<2>\puttree{mississippi-1-s}
\onslide<3>\puttree{mississippi-1-s_}
\onslide<4>\puttree{mississippi-1-s_i}
\onslide<5>\puttree{mississippi-1-s_ip}
\end{overprint}
\end{block}

}

\frame{

%\frametitle{Search Time}

\begin{block}{Search Time}
\begin{itemize}
\item $\sum_{i=0}^{k}C_i^m=\mathcal{O}(m^k)$ paths
\item $\mathcal{O}(m)$ per path
\item $\mathcal{O}(m^{k+1})$ total
\end{itemize}
\end{block}
}

\section{Construction}

\frame{
%\frametitle{A look at the tree}

\begin{block}{Dotted Tree}
\puttree{mississippi-1}
\end{block}

}


\frame{
%\frametitle{A close look at the tree}

\begin{block}{Close-up}
\puttree{suffix-link}
\end{block}

%\onslide<1->
%\begin{block}{Conclusion}
%Only leafs which correspond to positions in the string where the suffix-label occurrs are retained.
%\end{block}
	
}

\frame{
%\frametitle{Transformations}

\begin{block}{Rules}
\begin{itemize}
\item Leafs are labeled \textit{original - 1}
\item Leaf 1 is dropped
\item Only some leafs are retained (filter)
\end{itemize}
\end{block}

}


\frame{
%\frametitle{Construction I}

\begin{block}{Copy Root}
\puttree{mississippi-1-i}
\end{block}
}
\frame{
%\frametitle{Construction II}
\begin{block}{Copy First Level}
\puttree{mississippi-1-ii}

\invisible{Construction Time: $\mathcal{O}(kN|\Sigma|)$}
\end{block}

}\frame{
%\frametitle{Construction III}
\begin{block}{Copy Second Level}
\puttree{mississippi-1-iii}

\invisible{Construction Time: $\mathcal{O}(kN|\Sigma|)$}
\end{block}
}\frame{
%\frametitle{Construction IV}
\begin{block}{Copy Third Level}
\puttree{mississippi-1-iv}

\invisible{Construction Time: $\mathcal{O}(kN|\Sigma|)$}
\end{block}
}\frame{
%\frametitle{Construction V}
\begin{block}{Final Tree}
\puttree{mississippi-1}

\visible<2->{\flushright{}Construction Time: $\mathcal{O}(kN|\Sigma|)$}
\end{block}
}

\frame{
\begin{block}{Another Look}
\begin{itemize}
\item Look again
\item Count the number of created nodes per step
\item Count the steps
\end{itemize}
\end{block}
}

\frame{
\begin{block}{$\mathcal{O}(n)$ nodes}
\puttree{mississippi-1-i}
\end{block}
}
\frame{
\begin{block}{Add $\mathcal{O}(n)$ nodes}
\begin{overprint}
\onslide<1>
\puttree{mississippi-1-ii}

\flushright{}
Number Nodes: $\mathcal{O}(2n)$

\onslide<2>
\puttree{mississippi-1-iii}

\flushright
Number Nodes: $\mathcal{O}(3n)$

\onslide<3>
\puttree{mississippi-1-iv}

\flushright
Number Nodes: $\mathcal{O}(4n)$

\onslide<4>
\puttree{mississippi-1}

\flushright
Number Nodes: $\mathcal{O}(5n)$
\onslide<5>
\puttree{mississippi-1}

\flushright
Number Nodes: $\mathcal{O}(d_{\mathrm{max}}n)$
\end{overprint}
\end{block}
}


\frame{

%\frametitle{Deepest node}
\begin{block}{Deepest Node Schematics}
{\puttree{deepest}}
\begin{align*}
\mathrm{Worst Case}(d_\mathrm{max}) &=& n - 1\\
\mathrm{Expected Case}(d_\mathrm{max}) &=&\mathcal{O}(\log n)
\end{align*}
\end{block}
}

\section{Summary}

\frame{

\begin{block}{Main Results}
\begin{itemize}
\item Size $\mathcal{O}(n\log^k n)$
\item Search time $\mathcal{O}(m\log^{k+1})$
\item Construction $\mathcal{O}(kn\log^k n|\Sigma|)$
\end{itemize}
\end{block}
}

\frame{
\begin{block}{If you have any questions...}
...I will try to answer them.
\end{block}
}
\frame[b]{
	
\flushright
thank you.

\bigskip
\bigskip

}

\end{document}

